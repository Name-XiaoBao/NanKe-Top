import{Q as f,V as O}from"./api-bcd6585b.js";import{_ as L,u as h,r as p,m as I,a as c,o as g,e as V,d as u,w as v,F as R,s as m,b as t,t as r,f as U,c as B}from"./index-ca32026e.js";import"./Vote.vue_vue_type_style_index_0_lang-b1726fa2.js";import{s as x}from"./function-call-a99c9d20.js";function D(l,i){i||(i=window.location.href),l=l.replace(/[[\]]/g,"\\$&");const o=new RegExp("[?&]"+l+"(=([^&#]*)|&|#|$)"),e=o.exec(i);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null}const q={watch:{$route:function(){location.reload()}},methods:{useRoute:h},setup(){const l=h().query.uid,i=h().query.vote,o=p([]),e=p([]);I(()=>{f(i).then(a=>{e.value=a.data;const n=e.value.findIndex(s=>s.participatingUid===parseInt(l));n!==-1&&(o.value=e.value[n],o.value.Ranking=n+1,o.value.differ=e.value[n-1].numberOfVotes-o.value.numberOfVotes)}).catch(a=>{console.error(a)})});const _=p(!1);return{loading:_,onRefresh:()=>{f(i).then(a=>{e.value=a.data;const n=e.value.findIndex(s=>s.participatingUid===parseInt(l));n!==-1&&(o.value=e.value[n],o.value.Ranking=n+1,e.value[n-1]!=null?(o.value.differ=e.value[n-1].numberOfVotes-o.value.numberOfVotes,m("刷新成功"),_.value=!1):(m("刷新成功"),_.value=!1))}).catch(a=>{console.error(a)})},onClickLeft:()=>{window.open("/#/vote?uid="+D("vote",window.location.href),"_self")},detailsList:e,details:o,voter:()=>{new Date>new Date(e.value[0].deadline.replace(/-/g,"/"))?x({title:"提示",message:"这个投票已经结束啦~"}):O(i,l).then(a=>{a.code==200?x({title:a.msg,message:"ヾ(≧▽≦*)o"}).then(()=>{f(i).then(n=>{e.value=n.data;const s=e.value.findIndex(d=>d.participatingUid===parseInt(l));s!==-1&&(o.value=e.value[s],o.value.Ranking=s+1,o.value.differ=e.value[s-1].numberOfVotes-o.value.numberOfVotes)}).catch(n=>{console.error(n)})}):x({title:a.msg,message:"::>_<::"}).then(()=>{})}).catch(a=>{m(a.msg)})},test:()=>{alert(`暂未实现该功能
小暴正在努力开发中~`)}}}},N={style:{padding:"10px"}},E={style:{background:"rgba(234, 228, 203, 0.8)","border-radius":"10px"}},F={style:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column","text-align":"center"}},Q=["src"],T={style:{"margin-bottom":"0px"}},j={style:{display:"flex","text-align":"center"}},A={style:{flex:"1"}},M={style:{"margin-bottom":"-15px"}},P=t("h4",null,"排名",-1),S={style:{flex:"1"}},z={style:{"margin-bottom":"-15px"}},G=t("h4",null,"票数",-1),H={style:{flex:"1"}},J={style:{"margin-bottom":"-15px"}},K=t("h4",null,"距前名",-1),W={style:{margin:"10px"}},X={style:{"text-align":"center"}},Y=["src"],Z={style:{margin:"0 0 50px 0",background:"rgba(234, 228, 203, 0.8)","border-radius":"10px"}},$=t("div",{style:{"text-align":"center","padding-top":"5px"}},[t("h4",null,"排行榜")],-1),ee={style:{margin:"0px 15px"}},te=["src"],ne={style:{"margin-left":"auto","margin-right":"15px"}};function oe(l,i,o,e,_,y){const b=c("van-nav-bar"),k=c("van-divider"),w=c("router-link"),a=c("van-pull-refresh"),n=c("van-action-bar-button"),s=c("van-action-bar");return g(),V(R,null,[u(b,{title:"选手详情","left-arrow":"",onClickLeft:e.onClickLeft},null,8,["onClickLeft"]),u(a,{modelValue:e.loading,"onUpdate:modelValue":i[0]||(i[0]=d=>e.loading=d),onRefresh:e.onRefresh},{default:v(()=>[t("div",N,[t("div",E,[t("div",F,[t("img",{style:{width:"80px",height:"80px","border-radius":"50%",display:"block",margin:"20px 0px auto"},src:e.details.avatar},null,8,Q),t("h4",T,r(e.details.nickname),1)]),t("div",j,[t("div",A,[t("h4",M,r(e.details.Ranking),1),P]),t("div",S,[t("h4",z,r(e.details.numberOfVotes),1),G]),t("div",H,[t("h4",J,r(e.details.differ?e.details.differ:0)+"票",1),K])]),u(k),t("div",W,[t("p",X,r(e.details.title),1),t("pre",null,r(e.details.content),1),t("img",{style:{width:"100%"},src:e.details.picture},null,8,Y)])]),t("div",Z,[$,(g(!0),V(R,null,U(e.detailsList,(d,C)=>(g(),B(w,{style:{color:"#000",height:"80px","border-bottom":"1px solid #e3dfdf",display:"flex","align-items":"center"},to:{path:"/detail",query:{vote:y.useRoute().query.vote,uid:d.participatingUid}}},{default:v(()=>[t("span",ee,r(C+1),1),t("img",{style:{width:"50px",height:"50px","border-radius":"50%","margin-right":"10px"},src:d.avatar},null,8,te),t("span",null,r(d.nickname),1),t("span",ne,"票数："+r(d.numberOfVotes),1)]),_:2},1032,["to"]))),256))])])]),_:1},8,["modelValue","onRefresh"]),u(s,{style:{height:"54px"}},{default:v(()=>[u(n,{class:"topic",style:{"border-radius":"20px","margin-right":"2px",color:"#000"},type:"warning",text:"给TA投票",icon:"/application.png",onClick:e.voter},null,8,["onClick"]),u(n,{class:"topic",style:{"border-radius":"20px","margin-left":"2px",color:"#000"},type:"warning",text:"分享给好友",icon:"/share.png",onClick:e.test},null,8,["onClick"])]),_:1})],64)}const re=L(q,[["render",oe]]);export{re as default};
