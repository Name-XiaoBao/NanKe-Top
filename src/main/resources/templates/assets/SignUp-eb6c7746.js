import{_ as b,u as y,h as w,r as c,a as n,o as I,e as V,d as o,w as s,b as r,F as k,s as m,g as _,p as S,l as C}from"./index-ca32026e.js";import{P as D}from"./api-bcd6585b.js";import{s as g}from"./function-call-a99c9d20.js";const R={setup(){const l=y().query.uid;localStorage.getItem("username")==null&&g({title:"提示",message:"要先登录才能参加投票哦~"}).then(()=>{w.push("/user")});const t=c("/CoverImage.png"),i=c(null),e=c(null);return{Works:t,afterRead:a=>{t.value=a.content},Describe:e,title:i,publish:()=>{localStorage.getItem("username")===""||t.value==="/CoverImage.png"||l===""||t.value===""||i.value===""||e.value===""?m("信息未填写完整"):D(localStorage.getItem("username"),l,t.value,i.value,e.value).then(a=>{a.code==200?g({title:"提示",message:"参与投票成功！"}).then(()=>{history.go(-1)}):m(a.msg)}).catch(a=>{console.log(a)})}}}},U=l=>(S("data-v-ba911ea9"),l=l(),C(),l),q={style:{padding:"10px"}},B={style:{width:"100%",height:"100%",background:"#fff","border-radius":"10px","margin-bottom":"10px",display:"flex","flex-direction":"column","align-items":"center"}},N=U(()=>r("div",{style:{height:"20px","text-align":"center","padding-top":"15px","margin-bottom":"-15px"}},[r("b",null,"上传图片")],-1)),F=["src"];function P(l,t,i,e,f,h){const a=n("van-field"),p=n("van-cell-group"),v=n("van-divider"),u=n("van-button"),x=n("van-uploader");return I(),V(k,null,[o(p,{inset:"",style:{margin:"10px"}},{default:s(()=>[o(a,{style:{"border-radius":"10px"},required:"",modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=d=>e.title=d),maxlength:"15",label:"标题",placeholder:"请输入作品标题"},null,8,["modelValue"])]),_:1}),o(p,{inset:"",style:{margin:"10px"}},{default:s(()=>[o(a,{type:"textarea","label-align":"top",style:{"border-radius":"10px"},required:"",modelValue:e.Describe,"onUpdate:modelValue":t[1]||(t[1]=d=>e.Describe=d),autosize:"",maxlength:"150",label:"描述",placeholder:"请输入作品描述","show-word-limit":""},null,8,["modelValue"])]),_:1}),r("div",q,[r("div",B,[N,o(v),o(x,{"after-read":e.afterRead,style:{flex:"1",width:"100%",height:"100%",display:"flex","flex-direction":"column","align-items":"center","border-radius":"10px"}},{default:s(()=>[r("img",{src:e.Works,style:{width:"100%",height:"180px","object-fit":"cover"}},null,8,F),o(u,{plain:"",type:"default",style:{width:"100%","border-radius":"0 0 10px 10px"}},{default:s(()=>[_(" 点我上传/修改图片 ")]),_:1})]),_:1},8,["after-read"])]),o(u,{style:{"margin-top":"10px"},block:"",onClick:e.publish},{default:s(()=>[_("发布")]),_:1},8,["onClick"])])],64)}const z=b(R,[["render",P],["__scopeId","data-v-ba911ea9"]]);export{z as default};
